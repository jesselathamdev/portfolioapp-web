{% extends "base_two_columns.html" %}
{% load humanize %}

{% block browser_title %}Holdings{% endblock browser_title %}

{% block breadcrumbs %}<a href="/">Home</a> &rarr; <a href="{% url 'portfolio_index' %}">Portfolios</a> &rarr; {{ portfolio.name }}{% endblock breadcrumbs %}

{% block page_title %}Holdings{% endblock page_title %}

{% block content %}
{% if holdings %}
<table class="table table-striped table-striped-white table-hover table-bordered">
  <thead>
    <tr>
      <th>Name</th>
      <th class="align-right">Last Price</th>
      <th class="align-right">Position</th>
      <th class="align-right">Book Value<br /><span class="small">Avg Cost</span></th>
      <th class="align-right">Market Value</th>
      <th class="align-right">Net Gain</th>
      <th class="align-right">Portfolio<br />Makeup</th>
    </tr>
  </thead>
  <tbody>
  {% for holding in holdings %}
    <tr>
      <td>
        <a class="large" href="{% url 'transaction_index' portfolio.id holding.id %}">{{ holding.stock_symbol }}:{{ holding.market_code }}</a><br />
        <a href="{% url 'transaction_index' portfolio.id holding.id %}">{{ holding.stock_name }}</a>
      </td>
      <td class="align-right"><span class="medium">
        ${{ holding.last_price|floatformat:2|intcomma }}</span><br />
        <span class="small">{{ holding.date_last_price_updated }}</span>
      </td>
      <td class="align-right"><span class="medium">{{ holding.total_quantity|default_if_none:"0.00"|floatformat:5|intcomma }}</span></td>
      <td class="align-right"><span class="medium">
        ${{ holding.book_value|floatformat:2|intcomma }}</span><br />
        <span class="small">${{ holding.avg_cost|default_if_none:"0.00"|floatformat:2|intcomma }}</span>
      </td>
      <td class="align-right"><span class="medium">${{ holding.market_value|floatformat:2|intcomma }}</span></td>
      <td {% if holding.market_value > holding.book_value %}class="align-right indicator-gain"{% elif holding.market_value < holding.book_value %}class="align-right indicator-loss"{% else %}class="align-right"{% endif %}>
        <span class="medium">${{ holding.net_gain_dollar|floatformat:2|intcomma }}</span><br />
        <span class="small">{{ holding.net_gain_percent|floatformat:2|intcomma }}%</span>
      </td>
      <td class="align-right"><span class="medium">{{ holding.portfolio_makeup_percent|floatformat:2 }}%</span></td>
    </tr>
  {% endfor %}
  </tbody>
  <tfoot>
{#    <tr>#}
{#      <td colspan="3">Cash</td>#}
{#      <td class="align-right">$100.32</td>#}
{#      <td>&nbsp;</td>#}
{#      <td class="align-right">$100.32</td>#}
{#      <td class="align-right">3.00%</td>#}
{#    </tr>#}
    <tr class="total">
      <th colspan="3"><strong>Total</strong></th>
      <th class="align-right"><strong>${{ holding_summary.total_book_value|floatformat:2|intcomma }}</strong></th>
      <th class="align-right"><strong>${{ holding_summary.total_market_value|floatformat:2|intcomma }}</strong></th>
      <th class="align-right"><strong>${{ holding_summary.total_net_gain_dollar|floatformat:2|intcomma }}</strong></th>
      <th class="align-right">100%</th>
    </tr>
  </tfoot>
</table>
{% else %}
<p>You currently have no holdings in this portfolio - <a href="{% url 'holding_create' portfolio.id %}">go ahead and add some now!</a></p>
{% endif %}
{% endblock content %}

{% block sidebar %}
<div class="widget widget-simple">
  <div class="widget-header">
    <h3>Header</h3>
  </div>
  <div class="widget-body">
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris nisl nulla, mollis a fermentum non, posuere et neque. Praesent porttitor tellus in ligula dictum molestie. Nulla facilisi. Ut in odio urna, sit amet porttitor odio. In interdum odio id lacus semper volutpat. Maecenas dapibus nunc eget eros eleifend non faucibus enim placerat. Nam semper nisi ut dui auctor sit amet elementum elit mattis. Phasellus quis lectus eros, quis pharetra felis. Donec quis libero feugiat dui vehicula egestas. Sed velit libero, fringilla ut imperdiet eu, vehicula ac massa.</p>
  </div>
</div>
{% endblock sidebar %}