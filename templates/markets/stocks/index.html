{% extends 'base_app_two_columns.html' %}

{% load endless %}
{% load humanize %}

{% block browser_title %}Stocks{% endblock browser_title %}

{% block breadcrumbs %}<a href="/">Dashboard</a> &rarr; Stocks</a>{% endblock breadcrumbs %}

{% block page_title %}<i class="icon-list"></i> Stocks{% endblock page_title %}

{% block content %}

<form method="post" action="" class="form-inline">
  {% csrf_token %}
  <input type="text" id="tbSearch" name="search_term" class="twitter-typeahead" >
  <input type="submit" name="btnSearch" value="Search" class="btn">
  <input type="hidden" id="hidStockId" name="stock_id" value="">
</form>

<div id="paginate" class="endless_page_template">
  {% include page_template %}
</div>

{% endblock content %}

{% block sidebar %}
<div class="widget widget-simple">
  <div class="widget-header">
    <h4>Optional title of widget <small>subtitle</small></h4>
  </div>
  <div class="widget-body">
    <p class="lead">This is a subtitle of the widget</p>
    <p>Lorem ipsum dolor sit amet consectetuer pede tempor ligula sem tempus. A nascetur gravida parturient est Aenean facilisis In est consectetuer Nam. Adipiscing odio tincidunt ac ornare pellentesque metus diam laoreet sollicitudin vel.</p>
  </div>
</div>
{% endblock sidebar %}

{% block script %}
  <script src="{{ STATIC_URL }}js/twitter-hogan/hogan-2.0.0.min.js" type="text/javascript"></script>
  <script src="{{ STATIC_URL }}js/twitter-typeahead/typeahead.min.js" type="text/javascript"></script>

  {% verbatim %}
  <script type="text/javascript">
      $(document).ready(function() {
          $('.twitter-typeahead').typeahead({
              name: 'stocks',
              remote: '/api/markets/stocks2?q=%QUERY',
              valueKey: 'displayValue',
              template: '<p><strong>{{ name }}</strong> ({{ symbol }}:{{ acr }})<br /><small>Last price: ${{ last_price }}</small></p>',
              engine: Hogan,
              limit: 10,
              dataType: 'json'
          })
          .on('typeahead:selected', function(e, data) {
              $('#hidStockId').val(data['id']);
          })
          .on('typeahead:autocompleted', function(e, data) {
              alert('autocompleted');
          });
      });
  </script>
  {% endverbatim %}

  {% include "common/list_pagination_script.html" %}
{% endblock script %}